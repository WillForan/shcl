# Contributor : Antoine Carpentier
# Contributor : Stefan Husmann <stefan-husmann@t-online.de>
# Maintainer : Ivan Podmazov <ivanpzv[eight]@gmail.com>

pkgname=shcl
pkgver=r732.cc8d3c8
pkgrel=1
pkgdesc="POSIX Shell Meets Common Lisp"
arch=('any')
url="https://github.com/SquircleSpace/shcl"
license=('Apache')
makedepends=('sbcl' 'git' 'quicklisp')
source=('shcl::git+https://github.com/SquircleSpace/shcl')
md5sums=('SKIP')
options=(!strip)

pkgver() {
  cd "$pkgname"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

package() {
   cd "$pkgname"
   make LISP="sbcl --no-userinit --load \"/usr/lib/quicklisp/setup.lisp\" --eval '(ql:quickload :cffi-grovel)'"
   make PREFIX="$pkgdir/usr/" install
}
